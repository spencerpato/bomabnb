he Problem (Why Agent Login Fails)

Supabase authentication works, so the agent logs in successfully.

But your appâ€™s post-login check (where you redirect based on role) only looks for:

partner

superadmin

maybe admin
...and it doesnâ€™t include a condition for agent.
So the code falls to a â€œdefaultâ€ path â€” usually redirecting to homepage.

Thatâ€™s why youâ€™re just seeing the homepage with the logout button.

Also, since your alert logic runs after a role or status check, and the role agent is missing, no alert appears for pending or invalid logins.

ğŸ§­ Hereâ€™s What You Need to Do
1. Check Your Login Logic File (usually login.js or authHandler.js)

Thereâ€™s a section that checks something like:

if (role === "superadmin") {
  // redirect to superadmin dashboard
} else if (role === "partner") {
  // redirect to partner dashboard
}


âœ… Add this new condition right below:

else if (role === "agent") {
  if (status === "approved") {
    redirect("/agent-dashboard");
  } else if (status === "pending") {
    showAlert("Your agent account is pending approval.");
  } else if (status === "suspended") {
    showAlert("Your agent account has been suspended. Contact support.");
  } else {
    showAlert("Invalid agent credentials or unregistered account.");
  }
}

2. Ensure the Agent Table Is Queried After Login

Immediately after a successful Supabase login, fetch from the referrers table:

select * from referrers where email = user.email


If no record â†’ alert â€œInvalid agent credentials.â€
If found â†’ use the role and status fields for logic above.

3. Add Role & Status Columns (if missing)

In referrers table, make sure you have:

role â†’ "agent"

status â†’ "pending", "approved", or "suspended"

4. Verify Row-Level Security (RLS)

If youâ€™ve enabled RLS in Supabase, ensure your policies allow agents to read their own data (auth.uid() = user_id). Otherwise, the system wonâ€™t fetch their status, hence no redirect or alert.

5. Test Cases (Expected Behavior)
Scenario	Expected Outcome
Nonexistent agent	Alert â€œInvalid agent credentials.â€
Pending approval	Alert â€œYour agent account is pending approval.â€
Suspended agent	Alert â€œYour account is suspended.â€
Approved agent	Redirect to /agent-dashboard